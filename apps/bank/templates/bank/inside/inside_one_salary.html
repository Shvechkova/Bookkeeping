{% extends "core/base.html" %}
{% load static %}
{% load dict_filters %}
{% block content %}
    <link rel="stylesheet" href="{% static 'bank/css/inside_one_salary.css' %}">
    <div class="salary-container">
        <div class="salary-header">
            <div>Сотрудник</div>
            {% for month in months %}<div class="salary-month">{{ month }} {{ year_now }}</div>{% endfor %}
        </div>
        {% for employee in employees %}
            <div class="salary-employee-row">
                <div class="salary-employee-name">{{ employee.employee }}</div>
                {% for total in employee.total_by_month %}
                    <div class="salary-category-month-row">
                        <b>{{ total|floatformat:2 }} р</b>
                    </div>
                {% endfor %}
            </div>
            {% comment %} <div style="color: red; font-size: 12px;">DEBUG group_month_totals: {{ employee.group_month_totals }}</div> {% endcomment %}
            {% for group in employee.groups_full %}
                <div class="salary-group-row">
                    <div class="salary-group-name">
                        {% if group.name == 'group1' %}
                            ООО
                        {% elif group.name == 'group2' %}
                            $
                        {% elif group.name == 'group3' %}
                            КВ
                        {% elif group.name == 'group4' %}
                            Долги
                        {% else %}
                            {{ group.name }}
                        {% endif %}
                    </div>
                </div>
                {% comment %} <div style="color: blue; font-size: 12px;">DEBUG group.name: {{ group.name }}</div> {% endcomment %}
                {% with group_totals=employee.group_month_totals|get_item:group.name %}
                    {% for category in group.categories %}
                        <div class="salary-category-row">
                            <div class="salary-category-name">
                                {{ category.name }} — <b>{{ category.amount|floatformat:2 }} р</b>
                            </div>
                            {% for m in months %}
                                <div class="salary-category-month-row">
                                    {{ employee.categories_by_month|get_item:category.name|get_item:m|default:"0.00" }} р
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                    <div class="salary-total-row">
                        <div>
                            <b>
                                {% if group.name == 'group1' %}
                                    Итого ООО
                                {% elif group.name == 'group2' %}
                                    Итого $
                                {% elif group.name == 'group3' %}
                                    Итого КВ
                                {% elif group.name == 'group4' %}
                                    Остаток долга
                                {% endif %}
                            </b>
                        </div>
                        {% for total in group_totals %}<div class="salary-category-month-row">{{ total|floatformat:2 }} р</div>{% endfor %}
                    </div>
                {% endwith %}
            {% endfor %}
        {% endfor %}
    </div>
{% endblock content %}
